@using FashionStore.Models
@model List<Category>

@{
    ViewBag.Title = "Danh mục";
}
<div class="breadcrumb">
    <a href="index.html">Dashboard</a>
    <span class="breadcrumb-separator">/</span>
    <span>Danh mục</span>
</div>

<div class="content-area">
    <div class="d-flex justify-content-between align-items-center mb-6">
        <div>
            <h1>Quản lý Danh mục</h1>
            <p class="text-muted mt-1">Danh sách tất cả danh mục sản phẩm</p>
        </div>
        <a href="#" onclick="openModal('','addCategoryModal')" class="btn btn-primary">
            <svg style="width: 16px; height: 16px; margin-right: 0.5rem;" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Thêm danh mục
        </a>
    </div>

    <!-- Search -->
    <div class="card mb-6">
        <div class="card-content">
            @using (Html.BeginForm())
            {
                <input name="search" type="search" required="" id="searchInput" class="form-control"
                       placeholder="Tìm kiếm danh mục...">
            }
        </div>
    </div>

    <!-- Categories Grid -->
    <div class="grid grid-cols-3">
        @foreach (var i in Model)
        {
            <div class="card">
                <div class="card-content">
                    <div style="display: flex; align-items: start; gap: 1rem;">
                        <div
                            style="color: white; font-size: 25px; width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%); border-radius: var(--radius); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fa-solid fa-shirt"></i>
                        </div>
                        <div style="flex: 1;">
                            <h3>@i.CategoryName</h3>
                            <p class="text-muted mt-1">@i.Products.Count sản phẩm</p>
                            <div class="d-flex gap-2 mt-3">
                                <button
                                    onclick="fillEditCategoryModal(@i.CategoryID, '@i.CategoryName', @i.CategoryGroup.GroupID)"
                                    class="btn btn-outline btn-sm">Sửa
                                </button>
                                <button class="btn btn-danger btn-sm"
                                        onclick="confirmDelete(@i.CategoryID)">Xóa
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>


@*them danh muc*@
<div id="addCategoryModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Thêm danh mục mới</h3>
            <button class="btn btn-icon" onclick="closeModal('addCategoryModal')"
                    style="background: none; border: none; font-size: 24px;">×
            </button>
        </div>
        <div class="modal-body">
            @using (Html.BeginForm("Create", "Category", FormMethod.Post, new { id = "createCategoryForm" }))
            {
                <div class="form-group">
                    <label class="form-label">Tên danh mục <span class="text-danger">*</span></label>
                    <input name="CategoryName" type="text" class="form-control" required=""
                           placeholder="Nhập tên danh mục">
                </div>

                <div class="form-group">
                    <label class="form-label">Danh mục cha <span class="text-danger">*</span></label>
                    @Html.DropDownList("GroupID", new SelectList(ViewBag.CategoryGroups, "GroupID", "GroupName"), "Chọn danh mục cha", new { @class = "form-control", @required = "required" })
                </div>

                <div class="modal-footer">
                    <button class="btn btn-outline" onclick="closeModal('addCategoryModal')">Hủy</button>
                    <button class="btn btn-primary" type="submit">
                        Thêm danh mục
                    </button>
                </div>
            }
        </div>
    </div>
</div>


@*sua danh muc*@
<div id="editCategoryModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Chỉnh sửa danh mục</h3>
            <button class="btn btn-icon" onclick="closeModal('editCategoryModal')"
                    style="background: none; border: none; font-size: 24px;">×
            </button>
        </div>
        <div class="modal-body">
            @using (Html.BeginForm("Update", "Category", FormMethod.Post, new { id = "editCategoryForm" }))
            {
                @Html.Hidden("CategoryID", "")
                <div class="form-group">
                    <label class="form-label">Tên danh mục <span class="text-danger">*</span></label>
                    <input name="CategoryName" type="text" class="form-control" required=""
                           placeholder="Nhập tên danh mục">
                </div>

                <div class="form-group">
                    <label class="form-label">Danh mục cha <span class="text-danger">*</span></label>
                    @Html.DropDownList("GroupID", new SelectList(ViewBag.CategoryGroups, "GroupID", "GroupName"), new { @class = "form-control", @required = "required" })
                </div>
            }
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('editCategoryModal')">Hủy</button>
            <button class="btn btn-primary"
                    onclick="if(validateForm('editCategoryForm')) { closeModal('editCategoryModal'); submitUpdateForm()}">
                Cập nhật
            </button>
        </div>
    </div>
</div>

@using (Html.BeginForm("Delete", "Category", FormMethod.Post, new { id = "deleteCategoryForm", @class = "d-none" }))
{
    @Html.Hidden("id", "")
}

@section scripts{
    <script src="~/Content/js/Admin/category-admin.js"></script>
}